# 动漫妆造：睫毛流向

这个项目专注于（2020年前后） “二次元” 动漫建模动画角色眼部绘制中的眼眶和眼睫毛之间的关系，使用 MLP 神经网络，技术来实现眼睫毛的自动绘制。

<img src="./doc/example.png" width="200"/>

## 项目概述

本项目开发了一个神经网络模型，用于研究和预测两条曲线（曲线A代表眼眶，曲线B代表眼睫毛）之间的相对位置关系。这项技术主要应用于：

- 动画角色眼睫毛的自动绘制
- 确保眼睫毛曲线与眼眶轮廓的自然协调
- 提高动画制作效率

## 技术实现

### 神经网络架构
模型采用多层感知机(MLP)结构：
- 输入层：1个神经元
- 隐藏层1：64个神经元（ReLU激活）
- 隐藏层2：128个神经元（ReLU激活）
- 隐藏层3：64个神经元（ReLU激活）
- 输出层：2个神经元（用于切向和法向偏移量）

模型训练参数：
- 优化器：Adam
- 损失函数：均方误差(MSE)
- 评估指标：平均绝对误差(MAE)

### 数据分析视图

#### 原始曲线视图
- 显示眼眶和眼睫毛在原始坐标系中的形状
- 蓝线表示眼眶曲线（曲线A）
- 红线表示眼睫毛曲线（曲线B）
- 直观展示两条曲线的空间关系

<img src="./doc/curves_by_svg.png" width="500"/>

#### 相对运动视图

通过弧长参数化和局部坐标系转换，该系统能够将复杂的曲线关系转化为可训练的特征向量。将不规则采样的曲线转换为统一的参数表示，确保特征提取的一致性。通过计算切向量和法向量，建立局部坐标系，将相对位置关系分解为切向和法向分量。提供2D原始曲线、相对位置关系图和3D运动轨迹等多个维度的可视化结果。

<img src="./doc/relative_motion.png" width="500"/>

#### 训练数据（随机移动、缩放模拟真实场景）

<img src="./doc/train_data.png" width="500"/>


## 项目依赖

- NumPy：数值计算
- TensorFlow：深度学习框架
- Matplotlib：数据可视化
- SciPy：科学计算
- svg.path：SVG路径处理

## 使用说明

主要研究和实现内容在 `research.ipynb` Jupyter笔记本中，包括：
- 数据预处理和曲线分析
- 模型训练和评估
- 结果可视化
- 详细的方法说明

## 实现效果

```
Validation Statistics:
Mean Error: 5.0212 ± 2.8087 pixels
Min Error: 1.8515 pixels
Max Error: 11.9900 pixels
```

### 模型损失、平均绝对误差

<img src="./doc/Model_Loss_MAE.png" width="500"/>

### 模型预测效果

<img src="./doc/test_result.png" width="500"/>

![](./doc/test_results.png)

该模型能够：
1. 学习眼眶和眼睫毛之间的位置关系模式
2. 根据眼眶曲线预测眼睫毛的位置偏移
3. 通过多个视角展示复杂的空间关系
4. 自动生成符合角色风格的眼睫毛曲线



## 应用场景

- 动画制作中的角色眼部绘制
- 批量处理多个角色的眼睫毛绘制
- 保持同一角色在不同场景中的眼睫毛风格一致性
- 为新手动画师提供眼睫毛绘制参考

## 版权说明

本项目是Kigland Research计划的一部分。保留所有权利。
